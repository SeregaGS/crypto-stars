![Logo](https://raw.githubusercontent.com/SeregaGS/crypto-stars/3d40a2d30a1c6b27cc214ae3c0939a8edc2d25b2/img/svg/crypto-stars-logo.svg)

# Crypto-stars - P2P криптобиржа

Самостоятельная работа **по техническому заданию и критериям от HTML Academy**. Цель проекта - реализовать полноценный интерфейс криптобиржи Cryptostarts с возможеостью **покупать и продавать криптовалюту KEKS**.

Проект выполнен на **чистом JS** без фреймворков.

**[Ссылка на проект](https://seregags.github.io/crypto-stars/)**

## О проекте

Cryptostart - это одностраничное приложение, имитирующее работу P2P-площадки для обмена криптовалюты.
Приложение:

- Получает данные с сервера (fetch, async/await)
- Фильтрует контрагентов по статусу и верификации
- Отображает их как в списке, так и на интерактивной карте (Leaflet)
- Позволяет оформить сделку через модальные окна с валидацией форм (PristineJS)

## Используемые технологии

- **Vanila JS**
- **Leaflet.js** - работа с картой
- **Pristine.js** - валидация форм
- **Fetch API / async-await**

## Техническое задание и критерии

Макет проекта по **[ссылке](https://www.figma.com/design/yTpEBKXBLe0ZSkbuYkrYJ4/Crypto-stars.-%C2%ABJavaScript.-%D0%9F%D1%80%D0%BE%D1%84%D0%B5%D1%81%D1%81%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0-%D0%B2%D0%B5%D0%B1-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%BE%D0%B2%C2%BB?node-id=0-1&p=f)**.

<details> <summary><b>Техническое задание (ТЗ)</b></summary>

## **1. Основной слой (Главный экран)**

Основной слой имеет два режима отображения:

**1.1.** Список контрагентов

**1.2.** Карта продавцов

### **1.1. Режим списка контрагентов**

**Табы:** Должны быть переключатели между "Продавцы" и "Покупатели". При переключении таба список должен обновляться.

**Верификация:**

- Верифицированные контрагенты должны быть помечены иконкой-звёздочкой рядом с именем.
- Должен быть чекбокс "Показать только верифицированных". При его активации в списке остаются только контрагенты с атрибутом isVerified: true.

**Содержание списка:**

Для каждого контрагента в списке должно отображаться:

- Имя (userName)
- Валюта (balance.currency)
- Курс (exchangeRate)
- Лимиты сделок (minAmount и расчётный максимум).

**Дополнительно для продавцов:** Указываются платёжные системы (paymentMethods).

**Расчёт лимитов:**

- Минимум: Значение minAmount приходит с сервера в рублях.
- Максимум для продавца: Рассчитывается на основе количества KEKS на его счету (balance.amount) и его курса (exchangeRate).
- Максимум для покупателя: Равен сумме рублей на его счету (balance.amount).

### **1.2. Режим карты продавцов**

**Отображение на карте:** На карте метками отображаются только продавцы, у которых в paymentMethods указан способ "Cash in person".

**Координаты:**

- Координаты каждого продавца берутся из coords (широта и долгота).
- Начальные координаты карты: lat: 59.92749, lng: 30.31127 (Санкт-Петербург).

**Взаимодействие с метками:**

- При клике на метку открывается балун (используя API Leaflet) с описанием продавца.
- Верифицированные продавцы должны отмечаться меткой особого цвета.

**Фильтр верификации:** Чекбокс "Показать только верифицированных" должен работать и в этом режиме, скрывая неверифицированных продавцов.

**Сквозной фильтр:** Состояние чекбокса "Показать только верифицированных" должно сохраняться при переключении между режимом списка и режимом карты.

## **2. Модальный слой (Окно обмена)**

### **2.1. Общие требования к модальным окнам**

**Открытие:** Окно открывается по клику на кнопку "Обменять" у любого контрагента.

**Блокировка фона:** При открытии модального окна основная страница должна быть заблокирована (скролл запрещён).

**Закрытие:**

Окно закрывается:

- Кликом на крестик ("X").
- Кликом на оверлей (затемнённую область вокруг окна).
- Нажатием клавиши ESC.

**Сброс данных:** При закрытии окна все введённые пользователем данные должны удаляться (поля очищаться).

### **2.2. Функциональность покупки валюты (пользователь покупает KEKS за RUB)**

**Связь полей:**

- Поля "Оплата" (RUB) и "Зачисление" (KEKS) должны быть связаны.
- При вводе в одно поле второе должно автоматически пересчитываться на основе курса выбранного продавца.

**Функция расчёта:** Необходимо реализовать функцию для конвертации валют по указанному курсу.

**Кнопка "Обменять всё":**

- Должна быть доступна для обоих полей.
- При нажатии расчитывается максимально возможная сумма для сделки (все KEKS продавца или все RUB пользователя).

**Валидация:**

- Введённая сумма должна проверяться на соответствие минимальному и максимальному лимитам сделки.
- При ошибке поле должно выделяться красным, а под ним появляться сообщение об ошибке.

**Платёжная система:** Выпадающий список, options которого формируются из данных продавца (paymentMethods).

**Номер банковской карты:**

- Если выбран расчёт "Cash in person", поле остаётся пустым.
- В иных случаях в поле подставляется номер карты пользователя из его профиля.
- Редактирование поля вручную запрещено.

**Номер криптокошелька:** Заполняется данными из профиля пользователя (wallet.address). Редактирование запрещено.

**Платёжный пароль:** Поле обязательное для заполнения. Верный пароль для тестирования: 180712.

### **2.3. Функциональность продажи валюты (пользователь продаёт KEKS за RUB)**

**Источники данных:**

- Поле "Платёжная система" заполняется данными из профиля пользователя.
- Поле "Номер криптокошелька" заполняется данными из профиля контрагента (wallet.address).

**Валидация:** Правила валидации полей идентичны правилам при покупке.

### **2.4. Обработка ошибок в форме**

**Клиентская валидация:** Используется библиотека Pristine. При наличии ошибок отправка формы блокируется, а ошибки показываются под соответствующими полями.

**Успешная отправка:** Если ошибок нет, при отправке рядом с кнопкой "Обменять" появляется сообщение "Данные успешно отправлены".

**Ошибка сервера:** Если сервер вернул ошибку (невалидные данные, недоступен), под кнопкой "Обменять" показывается сообщение "Ошибка заполнения формы".

## **3. Работа с API и Сервером**

**Получение данных:**

- GET https://cryptostar.grading.htmlacademy.pro/user - данные о текущем пользователе.
- GET https://cryptostar.grading.htmlacademy.pro/contractors - данные о контрагентах (продавцах и покупателях).

Отправка данных:

- POST https://cryptostar.grading.htmlacademy.pro/

**Тип данных:** multipart/form-data

**Ожидаемые поля:**

- type (BUY/SELL)
- contractorId
- sendingCurrency (KEKS/RUB)
- sendingAmount
- exchangeRate
- receivingCurrency (KEKS/RUB)
- receivingAmount
- paymentMethod
- paymentPassword

**Разрешённые библиотеки**: В проекте разрешено использовать только API библиотек Pristine (для валидации) и Leaflet (для карты).

## **4. Обработка ошибок загрузки**

Если при первоначальной загрузке приложения сервер недоступен (не отвечает на запросы за пользователем или контрагентами), необходимо показать предусмотренную в вёрстке заглушку.

## **5. Дополнительно**

Дополнительная информация по работе с шаблонами и стилями находится в комментариях в файле index.

</details>

<details> <summary><b>Критерии</b></summary>
  ## Функциональность:

**Б1.** Полное соответствие техническому заданию

**Б2.** Отсутствие необработанных ошибок при работе приложения

## Именование:

**Б3.** camelCase для переменных и методов, PascalCase для перечислений

**Б4.** Английские существительные для переменных, допустимые сокращения

**Б5.** Множественное число для массивов

**Б6.** UPPER_SNAKE_CASE для констант

**Б7.** PascalCase для классов и перечислений

## Форматирование:

**Б9.** Обязательные блоки кода {}

**Б10.** Константы в начале модуля

**Б11.** Соответствие стилю проекта, прохождение ESLint

## Качество кода:

**Б12.** Отсутствие неиспользуемого кода

**Б13.** Фиксированные версии зависимостей

**Б14.** Нет недостижимого кода

**Б15.** Константы не переопределяются

**Б16.** Строгий режим

**Б17.** Строгие сравнения === и !==

**Б18.** Нет зарезервированных слов

## Архитектура:

**Б19.** ES2015 модули, правильные именования файлов

**Б20.** Нет экспорта изменяющихся переменных

## Кроссбраузерность:

**Б21.** Корректная работа в Chrome, Firefox, Safari, Edge

</details>
